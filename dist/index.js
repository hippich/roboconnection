!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("roboconnection",[],t):"object"==typeof exports?exports.roboconnection=t():e.roboconnection=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=33)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(75));var o=n(76);t.typeguards=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(74),r=function(){function e(e,t){this.owner=e,this.protocol=t,this.isComplete=!1,this.requestId="",this._complete=new o.default}return Object.defineProperty(e.prototype,"complete",{get:function(){return this._complete.promise},enumerable:!0,configurable:!0}),e.prototype.cancel=function(){if(!this.isComplete){this.isComplete=!0,this._complete.reject();var e={Type:"Cancel",ID:this.requestId};this.owner.sendRequest(e)}},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.owner=e}return e.prototype.sendToken=function(e){this.owner.sendToken(e)},e}();t.default=o},function(e,t,n){"use strict";var o=n(16),r=n(37),s=Object.prototype.toString;function i(e){return"[object Array]"===s.call(e)}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===s.call(e)}function u(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),i(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:r,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:u,merge:function e(){var t={};function n(n,o){"object"==typeof t[o]&&"object"==typeof n?t[o]=e(t[o],n):t[o]=n}for(var o=0,r=arguments.length;o<r;o++)u(arguments[o],n);return t},extend:function(e,t,n){return u(t,function(t,r){e[r]=n&&"function"==typeof t?o(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ALL_HANDLERS="ALL_HANDLERS",e.FIRST_HANDLER="FIRST_HANDLER",e.LAST_HANDLER="LAST_HANDLER"}(o=t.EmitterMode||(t.EmitterMode={}));var r=function(){function e(e){this.name=e,this._onceEvents=new Map,this._events=[],this._maxListeners=10,this._emitterMode=o.ALL_HANDLERS}return e.prototype.listeners=function(){return this._events.slice()},e.prototype.setMaxListeners=function(e){return this._maxListeners=e,this},e.prototype.getMaxListeners=function(){return this._maxListeners},e.prototype.once=function(e){var t=this,n=this._onceEvents.get(e);return n||(n=function(o){t._onceEvents.delete(e),t.removeListener(n),e(o)},this._onceEvents.set(e,n)),this.on(n)},e.prototype.on=function(e){return this._events.length>=this._maxListeners&&console.warn("Event '"+this.name+"': Max listeners "+this._maxListeners+" reached. ",(new Error).stack),this._events.push(e),this},e.prototype.removeLastListener=function(){this._events.splice(this._events.length-1,1)},e.prototype.removeFirstListener=function(){this._events.splice(0,1)},e.prototype.addListener=function(e){return this.on(e)},e.prototype.removeListener=function(e){for(var t=this._events.indexOf(e);-1!==t;)this._events.splice(t,1),t=this._events.indexOf(e,t);var n=this._onceEvents.get(e);if(n){for(var o=this._events.indexOf(n);-1!==o;)this._events.splice(o,1),o=this._events.indexOf(n,o);this._onceEvents.delete(e)}return this},e.prototype.off=function(e){return this.removeListener(e)},e.prototype.removeAllListeners=function(){return this._events=[],this._onceEvents.clear(),this},e.prototype.emit=function(e){if(this._emitterMode===o.ALL_HANDLERS)for(var t=this.listeners(),n=0;n<t.length;n++){(r=t[n])(e)}else{var r;if(this._emitterMode===o.LAST_HANDLER)return(r=this._events[this._events.length-1])&&r(e),!!r;if(this._emitterMode===o.FIRST_HANDLER)return(r=this._events[0])&&r(e),!!r}return this._events.length>0},e.prototype.setMode=function(e){if(!o[e])throw new Error("Emitter mode of typed events must be ALL_HANDLERS, FIRST_HANDLER, or LAST_HANDLER");this._emitterMode=e},e.prototype.waitFor=function(e){var t=this;return void 0===e&&(e=-1),new Promise(function(n,o){var r,s=function(e){r&&clearTimeout(r),n(e)};e>0&&(r=setTimeout(function(){t.removeListener(s),o("TIMEOUT")},e)),t.once(s)})},e.prototype.listenerCount=function(){return this._events.length},e}();t.Event=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateTransactionID=function(){if("object"==typeof process){var e=n(8),t="hi"+process.hrtime();return e.createHash("md5").update(t).digest("hex")}return uuid.v4().split("-").join("")}},function(e,t,n){"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("crypto")},function(e,t,n){"use strict";const o=n(69),r=n(23),s=n(15),i=n(6),a=Buffer.from([0,0,255,255]),c=Buffer.from([0]),u=Symbol("permessage-deflate"),p=Symbol("write-in-progress"),l=Symbol("pending-close"),f=Symbol("total-length"),h=Symbol("callback"),d=Symbol("buffers"),v=Symbol("error");let _;function y(e){this[d].push(e),this[f]+=e.length}function m(e){this[f]+=e.length,this[u]._maxPayload<1||this[f]<=this[u]._maxPayload?this[d].push(e):(this[v]=new RangeError("Max payload size exceeded"),this[v][i.kStatusCode]=1009,this.removeListener("data",m),this.reset())}function g(e){this[u]._inflate=null,e[i.kStatusCode]=1007,this[h](e)}e.exports=class{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!_){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;_=new o({concurrency:e})}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){this._inflate&&(this._inflate[p]?this._inflate[l]=!0:(this._inflate.close(),this._inflate=null)),this._deflate&&(this._deflate[p]?this._deflate[l]=!0:(this._deflate.close(),this._deflate=null))}acceptAsServer(e){const t=this._options,n=e.find(e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{var n=e[t];if(n.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(n=n[0],"client_max_window_bits"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}else if("server_max_window_bits"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==n)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}e[t]=n})}),e}decompress(e,t,n){_.push(o=>{this._decompress(e,t,(e,t)=>{o(),n(e,t)})})}compress(e,t,n){_.push(o=>{this._compress(e,t,(e,t)=>{o(),n(e,t)})})}_decompress(e,t,n){const o=this._isServer?"client":"server";if(!this._inflate){const e=`${o}_max_window_bits`,t="number"!=typeof this.params[e]?r.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=r.createInflateRaw(Object.assign({},this._options.zlibInflateOptions,{windowBits:t})),this._inflate[u]=this,this._inflate[f]=0,this._inflate[d]=[],this._inflate.on("error",g),this._inflate.on("data",m)}this._inflate[h]=n,this._inflate[p]=!0,this._inflate.write(e),t&&this._inflate.write(a),this._inflate.flush(()=>{const e=this._inflate[v];if(e)return this._inflate.close(),this._inflate=null,void n(e);const r=s.concat(this._inflate[d],this._inflate[f]);t&&this.params[`${o}_no_context_takeover`]||this._inflate[l]?(this._inflate.close(),this._inflate=null):(this._inflate[p]=!1,this._inflate[f]=0,this._inflate[d]=[]),n(null,r)})}_compress(e,t,n){if(!e||0===e.length)return void process.nextTick(n,null,c);const o=this._isServer?"server":"client";if(!this._deflate){const e=`${o}_max_window_bits`,t="number"!=typeof this.params[e]?r.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=r.createDeflateRaw(Object.assign({},this._options.zlibDeflateOptions,{windowBits:t})),this._deflate[f]=0,this._deflate[d]=[],this._deflate.on("data",y)}this._deflate[p]=!0,this._deflate.write(e),this._deflate.flush(r.Z_SYNC_FLUSH,()=>{var e=s.concat(this._deflate[d],this._deflate[f]);t&&(e=e.slice(0,e.length-4)),t&&this.params[`${o}_no_context_takeover`]||this._deflate[l]?(this._deflate.close(),this._deflate=null):(this._deflate[p]=!1,this._deflate[f]=0,this._deflate[d]=[]),n(null,e)})}}},function(e,t,n){"use strict";var o=n(3),r=n(39),s={"Content-Type":"application/x-www-form-urlencoded"};function i(e,t){!o.isUndefined(e)&&o.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a={adapter:function(){var e;return"undefined"!=typeof XMLHttpRequest?e=n(40):"undefined"!=typeof process&&(e=n(45)),e}(),transformRequest:[function(e,t){return r(t,"Content-Type"),o.isFormData(e)||o.isArrayBuffer(e)||o.isBuffer(e)||o.isStream(e)||o.isFile(e)||o.isBlob(e)?e:o.isArrayBufferView(e)?e.buffer:o.isURLSearchParams(e)?(i(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):o.isObject(e)?(i(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};o.forEach(["delete","get","head"],function(e){a.headers[e]={}}),o.forEach(["post","put","patch"],function(e){a.headers[e]=o.merge(s)}),e.exports=a},function(e,t,n){"use strict";var o=n(18);e.exports=function(e,t,n,r,s){var i=new Error(e);return o(i,t,n,r,s)}},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("url")},function(e,t){e.exports=require("events")},function(e,t,n){"use strict";function o(e,t){const n=Buffer.allocUnsafe(t);for(var o=0,r=0;r<e.length;r++){const t=e[r];t.copy(n,o),o+=t.length}return n}function r(e,t,n,o,r){for(var s=0;s<r;s++)n[o+s]=e[s]^t[3&s]}function s(e,t){const n=e.length;for(var o=0;o<n;o++)e[o]^=t[3&o]}try{const t=n(!function(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}()),i=t.BufferUtil||t;e.exports={mask(e,t,n,o,s){s<48?r(e,t,n,o,s):i.mask(e,t,n,o,s)},unmask(e,t){e.length<32?s(e,t):i.unmask(e,t)},concat:o}}catch(t){e.exports={concat:o,mask:r,unmask:s}}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),o=0;o<n.length;o++)n[o]=arguments[o];return e.apply(t,n)}}},function(e,t,n){"use strict";var o=n(11);e.exports=function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(o("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,o,r){return e.config=t,n&&(e.code=n),e.request=o,e.response=r,e}},function(e,t,n){"use strict";var o=n(3);function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(o.isURLSearchParams(t))s=t.toString();else{var i=[];o.forEach(t,function(e,t){null!==e&&void 0!==e&&(o.isArray(e)?t+="[]":e=[e],o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),i.push(r(t)+"="+r(e))}))}),s=i.join("&")}return s&&(e+=(-1===e.indexOf("?")?"?":"&")+s),e}},function(e,t,n){var o=n(13),r=n(7),s=n(12),i=n(46),a=n(21).Writable,c=n(47)("follow-redirects"),u={GET:!0,HEAD:!0,OPTIONS:!0,TRACE:!0},p=Object.create(null);function l(e,t){a.call(this),e.headers=e.headers||{},this._options=e,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var n=this;if(this._onNativeResponse=function(e){n._processResponse(e)},!e.pathname&&e.path){var o=e.path.indexOf("?");o<0?e.pathname=e.path:(e.pathname=e.path.substring(0,o),e.search=e.path.substring(o))}this._performRequest()}function f(e){var t={maxRedirects:21,maxBodyLength:10485760},n={};return Object.keys(e).forEach(function(r){var s=r+":",a=n[s]=e[r],u=t[r]=Object.create(a);u.request=function(e,r){return"string"==typeof e?(e=o.parse(e)).maxRedirects=t.maxRedirects:e=Object.assign({protocol:s,maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e),e.nativeProtocols=n,i.equal(e.protocol,s,"protocol mismatch"),c("options",e),new l(e,r)},u.get=function(e,t){var n=u.request(e,t);return n.end(),n}}),t}["abort","aborted","error","socket","timeout"].forEach(function(e){p[e]=function(t){this._redirectable.emit(e,t)}}),l.prototype=Object.create(a.prototype),l.prototype.write=function(e,t,n){if(!("string"==typeof e||"object"==typeof e&&"length"in e))throw new Error("data should be a string, Buffer or Uint8Array");"function"==typeof t&&(n=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,n)):(this.emit("error",new Error("Request body larger than maxBodyLength limit")),this.abort()):n&&n()},l.prototype.end=function(e,t,n){"function"==typeof e?(n=e,e=t=null):"function"==typeof t&&(n=t,t=null);var o=this._currentRequest;this.write(e||"",t,function(){o.end(null,null,n)})},l.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},l.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},["abort","flushHeaders","getHeader","setNoDelay","setSocketKeepAlive","setTimeout"].forEach(function(e){l.prototype[e]=function(t,n){return this._currentRequest[e](t,n)}}),["aborted","connection","socket"].forEach(function(e){Object.defineProperty(l.prototype,e,{get:function(){return this._currentRequest[e]}})}),l.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(t){if(this._options.agents){var n=e.substr(0,e.length-1);this._options.agent=this._options.agents[n]}var r=this._currentRequest=t.request(this._options,this._onNativeResponse);for(var s in this._currentUrl=o.format(this._options),r._redirectable=this,p)s&&r.on(s,p[s]);if(this._isRedirect){var i=0,a=this._requestBodyBuffers;!function e(){if(i<a.length){var t=a[i++];r.write(t.data,t.encoding,e)}else r.end()}()}}else this.emit("error",new Error("Unsupported protocol "+e))},l.prototype._processResponse=function(e){this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:e.statusCode});var t=e.headers.location;if(t&&!1!==this._options.followRedirects&&e.statusCode>=300&&e.statusCode<400){if(++this._redirectCount>this._options.maxRedirects)return void this.emit("error",new Error("Max redirects exceeded."));var n,r=this._options.headers;if(307!==e.statusCode&&!(this._options.method in u))for(n in this._options.method="GET",this._requestBodyBuffers=[],r)/^content-/i.test(n)&&delete r[n];if(!this._isRedirect)for(n in r)/^host$/i.test(n)&&delete r[n];var s=o.resolve(this._currentUrl,t);c("redirecting to",s),Object.assign(this._options,o.parse(s)),this._isRedirect=!0,this._performRequest(),e.destroy()}else e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),this._requestBodyBuffers=[]},e.exports=f({http:r,https:s}),e.exports.wrap=f},function(e,t){e.exports=require("stream")},function(e,t,n){function o(e){var n;function o(){if(o.enabled){var e=o,r=+new Date,s=r-(n||r);e.diff=s,e.prev=n,e.curr=r,n=r;for(var i=new Array(arguments.length),a=0;a<i.length;a++)i[a]=arguments[a];i[0]=t.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var c=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(n,o){if("%%"===n)return n;c++;var r=t.formatters[o];if("function"==typeof r){var s=i[c];n=r.call(e,s),i.splice(c,1),c--}return n}),t.formatArgs.call(e,i),(o.log||t.log||console.log.bind(console)).apply(e,i)}}return o.namespace=e,o.enabled=t.enabled(e),o.useColors=t.useColors(),o.color=function(e){var n,o=0;for(n in e)o=(o<<5)-o+e.charCodeAt(n),o|=0;return t.colors[Math.abs(o)%t.colors.length]}(e),o.destroy=r,"function"==typeof t.init&&t.init(o),t.instances.push(o),o}function r(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=o.debug=o.default=o).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var o=("string"==typeof e?e:"").split(/[\s,]+/),r=o.length;for(n=0;n<r;n++)o[n]&&("-"===(e=o[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var s=t.instances[n];s.enabled=t.enabled(s.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,o;for(n=0,o=t.skips.length;n<o;n++)if(t.skips[n].test(e))return!1;for(n=0,o=t.names.length;n<o;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(49),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){e.exports=require("zlib")},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function o(e){this.message=e}o.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},o.prototype.__CANCEL__=!0,e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(65),r=n(32),s=r.v1.session.Session,i=r.v1.expression.attention.Attention,a=r.v1.expression.lookAt.LookAt,c=r.v1.expression.display.Display,u=r.v1.expression.video.VideoPlayback,p=r.v1.lps.face.FaceTrack,l=r.v1.lps.motion.MotionTrack,f=r.v1.listen.hotWord.HotWord,h=r.v1.listen.listen.Listen,d=r.v1.expression.play.Play,v=r.v1.camera.photo.Photo,_=r.v1.camera.video.Video,y=r.v1.loadAssets.LoadAssets,m=r.v1.unloadAssets.UnloadAssets,g=r.v1.sensory.headTouch.HeadTouch,b=r.v1.settings.getConfig.GetConfig,w=r.v1.settings.setConfig.SetConfig,C=r.v1.sensory.screenGesture.ScreenGesture,T=n(0),E=n(4),k=n(5),S=function(){function e(){var e=this;this.robotVersion="1.0",this.AppID="",this.sessionId="",this.robotName="",this.inProgressTokens=new Map,this.connection=new o.default,this.connection.message.on(this.onMessage.bind(this)),this.connection.disconnected.on(function(t){e.disconnected.emit({code:t.code,reason:t.reason})}),this.attention=new i(this),this.lookAt=new a(this),this.display=new c(this),this.videoPlayback=new u(this),this.faceTrack=new p(this),this.motionTrack=new l(this),this.play=new d(this),this.photo=new v(this),this.video=new _(this),this.loadAssets=new y(this),this.unloadAssets=new m(this),this.listen=new h(this),this.hotWord=new f(this),this.getConfig=new b(this),this.setConfig=new w(this),this.session=new s(this),this.headTouch=new g(this),this.screenGesture=new C(this),this.disconnected=new E.Event("Disconnected"),this.expression={say:function(t){return e.play.say(t)},look:function(t){if(t)switch(t.type){case"ANGLE":var n=[t.angle.theta,0];return e.lookAt.angle(n);case"POSITION":var o=t.position,r=[o.x,o.y,o.z];return e.lookAt.position(r)}},setAttentionMode:function(t){return e.attention.setMode(t)}},this.config={set:function(t){return t.mixer&&!t.Mixer&&(t.Mixer=t.mixer),e.setConfig.set(t)}},this.perception={subscribe:{motion:function(){return e.motionTrack.trackMotions()},face:function(){return e.faceTrack.trackFaces()}}},this.listen.subscribe.hotword=function(t){return void 0===t&&(t=!1),e.hotWord.listen(t)}}return e.prototype.connect=function(e,t){var n=this;return this.robotName=e,this.connection.connect(e,t).then(function(){return n.session.startSession().complete.then(function(e){n.robotVersion=e.ResponseBody.Version,n.sessionId=e.ResponseBody.SessionID}).catch(function(e){console.log("Requester : connect: token: error:",e)})}).catch(function(e){console.log("Requester : connect: connection: error:",e)})},e.prototype.disconnect=function(){this.connection.close()},e.prototype.generateTransactionID=function(){return k.generateTransactionID()},e.prototype.sendRequest=function(e){var t=this.generateTransactionID(),n={TransactionID:t,SessionID:this.sessionId,Version:this.robotVersion,Credentials:null,AppID:this.AppID};return this.connection.sendTo(this.robotName,{ClientHeader:n,Command:e}),t},e.prototype.sendToken=function(e){e.requestId=this.sendRequest(e.protocol),e.isComplete||this.inProgressTokens.set(e.requestId,e)},e.prototype.onMessage=function(e){var t=e.data,n=null,o=null,r=null;if(T.typeguards.isAcknowledgement(t))n=t.ResponseHeader.TransactionID,o=t;else{if(!T.typeguards.isEvent(t))return;n=t.EventHeader.TransactionID,r=t}if(this.inProgressTokens.has(n)){var s=this.inProgressTokens.get(n);s&&(o?s.handleAck(o):r&&s.handleEvent(r),s.isComplete&&this.inProgressTokens.delete(n))}},e}();t.default=S},function(e,t,n){"use strict";const o=n(14),r=n(8),s=n(12),i=n(7),a=n(67),c=n(68),u=n(13),p=n(9),l=n(70),f=n(28),h=n(6),d=n(29),v=n(31),_=["CONNECTING","OPEN","CLOSING","CLOSED"],y=h.kWebSocket,m=[8,13],g=3e4;class b extends o{constructor(e,t,n){super(),this.readyState=b.CONNECTING,this.protocol="",this._binaryType=h.BINARY_TYPES[0],this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._closeCode=1006,this._extensions={},this._isServer=!0,this._receiver=null,this._sender=null,this._socket=null,null!==e&&(Array.isArray(t)?t=t.join(", "):"object"==typeof t&&null!==t&&(n=t,t=void 0),function(e,t,n){if(n=Object.assign({protocolVersion:m[1],perMessageDeflate:!0,maxPayload:104857600},n,{createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,auth:void 0,host:void 0,path:void 0,port:void 0}),-1===m.indexOf(n.protocolVersion))throw new RangeError(`Unsupported protocol version: ${n.protocolVersion} `+`(supported versions: ${m.join(", ")})`);var o;this._isServer=!1,"object"==typeof e&&void 0!==e.href?(o=e,this.url=e.href):(o=u.URL?new u.URL(e):u.parse(e),this.url=e);const a="ws+unix:"===o.protocol;if(!(o.host||a&&o.pathname))throw new Error(`Invalid URL: ${this.url}`);const c="wss:"===o.protocol||"https:"===o.protocol,l=r.randomBytes(16).toString("base64"),d=c?s:i,v=o.search?`${o.pathname||"/"}${o.search}`:o.pathname||"/";var _;n.createConnection=c?C:w,n.port=o.port||(c?443:80),n.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,n.headers=Object.assign({"Sec-WebSocket-Version":n.protocolVersion,"Sec-WebSocket-Key":l,Connection:"Upgrade",Upgrade:"websocket"},n.headers),n.path=v,n.perMessageDeflate&&(_=new p(!0!==n.perMessageDeflate?n.perMessageDeflate:{},!1,n.maxPayload),n.headers["Sec-WebSocket-Extensions"]=f.format({[p.extensionName]:_.offer()}));t&&(n.headers["Sec-WebSocket-Protocol"]=t);n.origin&&(n.protocolVersion<13?n.headers["Sec-WebSocket-Origin"]=n.origin:n.headers.Origin=n.origin);o.auth?n.auth=o.auth:(o.username||o.password)&&(n.auth=`${o.username}:${o.password}`);if(a){const e=v.split(":");n.socketPath=e[0],n.path=e[1]}var y=this._req=d.get(n);n.handshakeTimeout&&y.setTimeout(n.handshakeTimeout,()=>T(this,y,"Opening handshake has timed out"));y.on("error",e=>{this._req.aborted||(y=this._req=null,this.readyState=b.CLOSING,this.emit("error",e),this.emitClose())}),y.on("response",e=>{this.emit("unexpected-response",y,e)||T(this,y,`Unexpected server response: ${e.statusCode}`)}),y.on("upgrade",(e,o,s)=>{if(this.emit("upgrade",e),this.readyState!==b.CONNECTING)return;y=this._req=null;const i=r.createHash("sha1").update(l+h.GUID,"binary").digest("base64");if(e.headers["sec-websocket-accept"]!==i)return void T(this,o,"Invalid Sec-WebSocket-Accept header");const a=e.headers["sec-websocket-protocol"],c=(t||"").split(/, */);var u;if(!t&&a?u="Server sent a subprotocol but none was requested":t&&!a?u="Server sent no subprotocol":a&&-1===c.indexOf(a)&&(u="Server sent an invalid subprotocol"),u)T(this,o,u);else{if(a&&(this.protocol=a),_)try{const t=f.parse(e.headers["sec-websocket-extensions"]);t[p.extensionName]&&(_.accept(t[p.extensionName]),this._extensions[p.extensionName]=_)}catch(e){return void T(this,o,"Invalid Sec-WebSocket-Extensions header")}this.setSocket(o,s,n.maxPayload)}})}.call(this,e,t,n))}get CONNECTING(){return b.CONNECTING}get CLOSING(){return b.CLOSING}get CLOSED(){return b.CLOSED}get OPEN(){return b.OPEN}get binaryType(){return this._binaryType}set binaryType(e){h.BINARY_TYPES.indexOf(e)<0||(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?(this._socket.bufferSize||0)+this._sender._bufferedBytes:0}get extensions(){return Object.keys(this._extensions).join()}setSocket(e,t,n){const o=new d(this._binaryType,this._extensions,n);this._sender=new v(e,this._extensions),this._receiver=o,this._socket=e,o[y]=this,e[y]=this,o.on("conclude",E),o.on("drain",k),o.on("error",S),o.on("message",O),o.on("ping",P),o.on("pong",R),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",A),e.on("data",L),e.on("end",j),e.on("error",M),this.readyState=b.OPEN,this.emit("open")}emitClose(){this.readyState=b.CLOSED,this._socket?(this._extensions[p.extensionName]&&this._extensions[p.extensionName].cleanup(),this._receiver.removeAllListeners(),this.emit("close",this._closeCode,this._closeMessage)):this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==b.CLOSED){if(this.readyState===b.CONNECTING){const e="WebSocket was closed before the connection was established";return T(this,this._req,e)}this.readyState!==b.CLOSING?(this.readyState=b.CLOSING,this._sender.close(e,t,!this._isServer,e=>{e||(this._closeFrameSent=!0,this._socket.writable&&(this._closeFrameReceived&&this._socket.end(),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),g)))})):this._closeFrameSent&&this._closeFrameReceived&&this._socket.end()}}ping(e,t,n){if("function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),this.readyState!==b.OPEN){const e=new Error(`WebSocket is not open: readyState ${this.readyState} `+`(${_[this.readyState]})`);if(n)return n(e);throw e}"number"==typeof e&&(e=e.toString()),void 0===t&&(t=!this._isServer),this._sender.ping(e||h.EMPTY_BUFFER,t,n)}pong(e,t,n){if("function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),this.readyState!==b.OPEN){const e=new Error(`WebSocket is not open: readyState ${this.readyState} `+`(${_[this.readyState]})`);if(n)return n(e);throw e}"number"==typeof e&&(e=e.toString()),void 0===t&&(t=!this._isServer),this._sender.pong(e||h.EMPTY_BUFFER,t,n)}send(e,t,n){if("function"==typeof t&&(n=t,t={}),this.readyState!==b.OPEN){const e=new Error(`WebSocket is not open: readyState ${this.readyState} `+`(${_[this.readyState]})`);if(n)return n(e);throw e}"number"==typeof e&&(e=e.toString());const o=Object.assign({binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0},t);this._extensions[p.extensionName]||(o.compress=!1),this._sender.send(e||h.EMPTY_BUFFER,o,n)}terminate(){if(this.readyState!==b.CLOSED){if(this.readyState===b.CONNECTING){const e="WebSocket was closed before the connection was established";return T(this,this._req,e)}this._socket&&(this.readyState=b.CLOSING,this._socket.destroy())}}}function w(e){return e.protocolVersion&&(e.path=e.socketPath),a.connect(e)}function C(e){return e.path=void 0,e.servername=e.servername||e.host,c.connect(e)}function T(e,t,n){e.readyState=b.CLOSING;const o=new Error(n);Error.captureStackTrace(o,T),t.setHeader?(t.abort(),t.once("abort",e.emitClose.bind(e)),e.emit("error",o)):(t.destroy(o),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function E(e,t){const n=this[y];n._socket.removeListener("data",L),n._socket.resume(),n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=e,1005===e?n.close():n.close(e,t)}function k(){this[y]._socket.resume()}function S(e){const t=this[y];t._socket.removeListener("data",L),t.readyState=b.CLOSING,t._closeCode=e[h.kStatusCode],t.emit("error",e),t._socket.destroy()}function x(){this[y].emitClose()}function O(e){this[y].emit("message",e)}function P(e){const t=this[y];t.pong(e,!t._isServer,h.NOOP),t.emit("ping",e)}function R(e){this[y].emit("pong",e)}function A(){const e=this[y];this.removeListener("close",A),this.removeListener("end",j),e.readyState=b.CLOSING,e._socket.read(),e._receiver.end(),this.removeListener("data",L),this[y]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",x),e._receiver.on("finish",x))}function L(e){this[y]._receiver.write(e)||this.pause()}function j(){const e=this[y];e.readyState=b.CLOSING,e._receiver.end(),this.end()}function M(){const e=this[y];this.removeListener("error",M),this.on("error",h.NOOP),e&&(e.readyState=b.CLOSING,this.destroy())}_.forEach((e,t)=>{b[_[t]]=t}),["open","error","close","message"].forEach(e=>{Object.defineProperty(b.prototype,`on${e}`,{get(){const t=this.listeners(e);for(var n=0;n<t.length;n++)if(t[n]._listener)return t[n]._listener},set(t){const n=this.listeners(e);for(var o=0;o<n.length;o++)n[o]._listener&&this.removeListener(e,n[o]);this.addEventListener(e,t)}})}),b.prototype.addEventListener=l.addEventListener,b.prototype.removeEventListener=l.removeEventListener,e.exports=b},function(e,t,n){"use strict";const o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function r(e,t,n){Object.prototype.hasOwnProperty.call(e,t)?e[t].push(n):e[t]=[n]}e.exports={format:function(e){return Object.keys(e).map(t=>{var n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>[t].concat(Object.keys(e).map(t=>{var n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){const t={};if(void 0===e||""===e)return t;for(var n,s,i={},a=!1,c=!1,u=!1,p=-1,l=-1,f=0;f<e.length;f++){const d=e.charCodeAt(f);if(void 0===n)if(-1===l&&1===o[d])-1===p&&(p=f);else if(32===d||9===d)-1===l&&-1!==p&&(l=f);else{if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${f}`);{if(-1===p)throw new SyntaxError(`Unexpected character at index ${f}`);-1===l&&(l=f);const o=e.slice(p,l);44===d?(r(t,o,i),i={}):n=o,p=l=-1}}else if(void 0===s)if(-1===l&&1===o[d])-1===p&&(p=f);else if(32===d||9===d)-1===l&&-1!==p&&(l=f);else if(59===d||44===d){if(-1===p)throw new SyntaxError(`Unexpected character at index ${f}`);-1===l&&(l=f),r(i,e.slice(p,l),!0),44===d&&(r(t,n,i),i={},n=void 0),p=l=-1}else{if(61!==d||-1===p||-1!==l)throw new SyntaxError(`Unexpected character at index ${f}`);s=e.slice(p,f),p=l=-1}else if(c){if(1!==o[d])throw new SyntaxError(`Unexpected character at index ${f}`);-1===p?p=f:a||(a=!0),c=!1}else if(u)if(1===o[d])-1===p&&(p=f);else if(34===d&&-1!==p)u=!1,l=f;else{if(92!==d)throw new SyntaxError(`Unexpected character at index ${f}`);c=!0}else if(34===d&&61===e.charCodeAt(f-1))u=!0;else if(-1===l&&1===o[d])-1===p&&(p=f);else if(-1===p||32!==d&&9!==d){if(59!==d&&44!==d)throw new SyntaxError(`Unexpected character at index ${f}`);if(-1===p)throw new SyntaxError(`Unexpected character at index ${f}`);-1===l&&(l=f);var h=e.slice(p,l);a&&(h=h.replace(/\\/g,""),a=!1),r(i,s,h),44===d&&(r(t,n,i),i={},n=void 0),s=void 0,p=l=-1}else-1===l&&(l=f)}if(-1===p||u)throw new SyntaxError("Unexpected end of input");-1===l&&(l=f);const d=e.slice(p,l);return void 0===n?r(t,d,{}):(void 0===s?r(i,d,!0):r(i,s,a?d.replace(/\\/g,""):d),r(t,n,i)),t}}},function(e,t,n){"use strict";const o=n(21),r=n(9),s=n(15),i=n(30),a=n(6),c=0,u=1,p=2,l=3,f=4,h=5;function d(e,t,n,o){const r=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(r,d),r[a.kStatusCode]=o,r}function v(e,t){return 1===e.length?e[0]:e.length>1?s.concat(e,t):a.EMPTY_BUFFER}e.exports=class extends o.Writable{constructor(e,t,n){super(),this._binaryType=e||a.BINARY_TYPES[0],this[a.kWebSocket]=void 0,this._extensions=t||{},this._maxPayload=0|n,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=c,this._loop=!1}_write(e,t,n){if(8===this._opcode)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const n=this._buffers[0];e>=n.length?this._buffers.shift().copy(t,t.length-e):(n.copy(t,t.length-e,0,e),this._buffers[0]=n.slice(e)),e-=n.length}while(e>0);return t}startLoop(e){var t;this._loop=!0;do{switch(this._state){case c:t=this.getInfo();break;case u:t=this.getPayloadLength16();break;case p:t=this.getPayloadLength64();break;case l:this.getMask();break;case f:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,d(RangeError,"RSV2 and RSV3 must be clear",!0,1002);const t=64==(64&e[0]);if(t&&!this._extensions[r.extensionName])return this._loop=!1,d(RangeError,"RSV1 must be clear",!0,1002);if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,d(RangeError,"RSV1 must be clear",!0,1002);if(!this._fragmented)return this._loop=!1,d(RangeError,"invalid opcode 0",!0,1002);this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,d(RangeError,`invalid opcode ${this._opcode}`,!0,1002);this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,d(RangeError,`invalid opcode ${this._opcode}`,!0,1002);if(!this._fin)return this._loop=!1,d(RangeError,"FIN must be set",!0,1002);if(t)return this._loop=!1,d(RangeError,"RSV1 must be clear",!0,1002);if(this._payloadLength>125)return this._loop=!1,d(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002)}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),126===this._payloadLength)this._state=u;else{if(127!==this._payloadLength)return this.haveLength();this._state=p}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,d(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009)):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,d(RangeError,"Max payload size exceeded",!1,1009);this._masked?this._state=l:this._state=f}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=f)}getData(e){var t=a.EMPTY_BUFFER;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&s.unmask(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=h,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[r.extensionName].decompress(e,this._fin,(e,n)=>{if(e)return t(e);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(d(RangeError,"Max payload size exceeded",!1,1009));this._fragments.push(n)}const o=this.dataMessage();if(o)return t(o);this.startLoop(t)})}dataMessage(){if(this._fin){const t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){var e;e="nodebuffer"===this._binaryType?v(n,t):"arraybuffer"===this._binaryType?function(e){return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}(v(n,t)):n,this.emit("message",e)}else{const e=v(n,t);if(!i.isValidUTF8(e))return this._loop=!1,d(Error,"invalid UTF-8 sequence",!0,1007);this.emit("message",e.toString())}}this._state=c}controlMessage(e){if(8!==this._opcode)9===this._opcode?this.emit("ping",e):this.emit("pong",e),this._state=c;else if(this._loop=!1,0===e.length)this.emit("conclude",1005,""),this.end();else{if(1===e.length)return d(RangeError,"invalid payload length 1",!0,1002);{const t=e.readUInt16BE(0);if(!i.isValidStatusCode(t))return d(RangeError,`invalid status code ${t}`,!0,1002);const n=e.slice(2);if(!i.isValidUTF8(n))return d(Error,"invalid UTF-8 sequence",!0,1007);this.emit("conclude",t,n.toString()),this.end()}}}}},function(e,t,n){"use strict";try{const e=n(!function(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}());t.isValidUTF8="object"==typeof e?e.Validation.isValidUTF8:e}catch(e){t.isValidUTF8=(()=>!0)}t.isValidStatusCode=(e=>e>=1e3&&e<=1013&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999)},function(e,t,n){"use strict";const o=n(8),r=n(9),s=n(15),i=n(30),a=n(6);class c{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){const n=e.length<1024||t.mask&&t.readOnly;var r=t.mask?6:2,i=e.length;e.length>=65536?(r+=8,i=127):e.length>125&&(r+=2,i=126);const a=Buffer.allocUnsafe(n?e.length+r:r);if(a[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(a[0]|=64),126===i?a.writeUInt16BE(e.length,2):127===i&&(a.writeUInt32BE(0,2),a.writeUInt32BE(e.length,6)),!t.mask)return a[1]=i,n?(e.copy(a,r),[a]):[a,e];const c=o.randomBytes(4);return a[1]=128|i,a[r-4]=c[0],a[r-3]=c[1],a[r-2]=c[2],a[r-1]=c[3],n?(s.mask(e,c,a,r,e.length),[a]):(s.mask(e,c,e,0,e.length),[a,e])}close(e,t,n,o){var r;if(void 0===e)r=a.EMPTY_BUFFER;else{if("number"!=typeof e||!i.isValidStatusCode(e))throw new TypeError("First argument must be a valid error code number");void 0===t||""===t?(r=Buffer.allocUnsafe(2)).writeUInt16BE(e,0):((r=Buffer.allocUnsafe(2+Buffer.byteLength(t))).writeUInt16BE(e,0),r.write(t,2))}this._deflating?this.enqueue([this.doClose,r,n,o]):this.doClose(r,n,o)}doClose(e,t,n){this.sendFrame(c.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),n)}ping(e,t,n){var o=!0;Buffer.isBuffer(e)||(e instanceof ArrayBuffer?e=Buffer.from(e):ArrayBuffer.isView(e)?e=u(e):(e=Buffer.from(e),o=!1)),this._deflating?this.enqueue([this.doPing,e,t,o,n]):this.doPing(e,t,o,n)}doPing(e,t,n,o){this.sendFrame(c.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:n}),o)}pong(e,t,n){var o=!0;Buffer.isBuffer(e)||(e instanceof ArrayBuffer?e=Buffer.from(e):ArrayBuffer.isView(e)?e=u(e):(e=Buffer.from(e),o=!1)),this._deflating?this.enqueue([this.doPong,e,t,o,n]):this.doPong(e,t,o,n)}doPong(e,t,n,o){this.sendFrame(c.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:n}),o)}send(e,t,n){var o=t.binary?2:1,s=t.compress,i=!0;Buffer.isBuffer(e)||(e instanceof ArrayBuffer?e=Buffer.from(e):ArrayBuffer.isView(e)?e=u(e):(e=Buffer.from(e),i=!1));const a=this._extensions[r.extensionName];if(this._firstFragment?(this._firstFragment=!1,s&&a&&(s=e.length>=a._threshold),this._compress=s):(s=!1,o=0),t.fin&&(this._firstFragment=!0),a){const r={fin:t.fin,rsv1:s,opcode:o,mask:t.mask,readOnly:i};this._deflating?this.enqueue([this.dispatch,e,this._compress,r,n]):this.dispatch(e,this._compress,r,n)}else this.sendFrame(c.frame(e,{fin:t.fin,rsv1:!1,opcode:o,mask:t.mask,readOnly:i}),n)}dispatch(e,t,n,o){if(!t)return void this.sendFrame(c.frame(e,n),o);const s=this._extensions[r.extensionName];this._deflating=!0,s.compress(e,n.fin,(e,t)=>{if(this._deflating=!1,!this._socket.readable&&!this._socket.writable)return this._bufferedBytes=0,void(this._queue.length=0);n.readOnly=!1,this.sendFrame(c.frame(t,n),o),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[1].length,e[0].apply(this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.write(e[0]),this._socket.write(e[1],t)):this._socket.write(e[0],t)}}function u(e){const t=Buffer.from(e.buffer);return e.byteLength!==e.buffer.byteLength?t.slice(e.byteOffset,e.byteOffset+e.byteLength):t}e.exports=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(72);t.v1=o;var r=n(100);t.v2=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(34);t.JiboConnection=o.JiboConnection;var r=n(26);t.Requester=r.default},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(35),s=n(14),i=n(64),a=function(e){function t(t,n){var o=e.call(this)||this;return o._numTries=0,o._gotCertificate=!1,o._p12Certificate="",o._certificateFingerprint="",o._accessToken="",o._tokenType="",o._interval=null,o._connected=!1,o._debugLogging=!1,o._robotInfo=t,o._connectionInfo=n,o}return o(t,e),t.prototype.connect=function(e){void 0===e&&(e=!1),this._debugLogging=e,this._robotInfo.serialName&&this._robotInfo.endpoint&&this._robotInfo.email&&this._robotInfo.password&&this._connectionInfo.clientId&&this._connectionInfo.clientSecret&&this._connectionInfo.port?this.login():(this.logError("JiboConnection: constructor: unable to login",this._robotInfo,this._connectionInfo),this.statusMessage("constructor: unable to login"))},t.prototype.login=function(){var e=this,t="https://"+this._robotInfo.endpoint+"/token",n={grant_type:"password",client_id:this._connectionInfo.clientId,client_secret:this._connectionInfo.clientSecret,username:this._robotInfo.email,password:this._robotInfo.password};r.default({method:"post",headers:{"User-Agent":"Mozilla/5.0",Accept:"application/json","Content-Type":"application/json"},url:t,data:JSON.stringify(n)}).then(function(t){e.logDebug(t.data);var n=t.data;e.logDebug(n),e.statusMessage("login(): success"),e._accessToken=n.access_token,e._tokenType=n.token_type,e.getRobotList()}).catch(function(t){e.logError("Error: login",t),e.statusMessage("Error: login(): "+t)})},t.prototype.getRobotList=function(){var e=this,t="https://"+this._robotInfo.endpoint+"/rom/v1/robots";r.default({method:"get",headers:{"User-Agent":"Mozilla/5.0",Accept:"application/json","Content-Type":"application/json",Authorization:this._tokenType+" "+this._accessToken},url:t}).then(function(t){var n=t.data;e.statusMessage("getRobotList(): success"),e.logDebug("JiboConnection: getRobotList: list: ",n),e.logDebug("JiboConnection: getRobotList: should confirm that: "+e._robotInfo.serialName+" is in\n "+JSON.stringify(n,null,2)),e.logDebug("JiboConnection: getRobotList: using: "+e._robotInfo.serialName),e.createCertificate()}).catch(function(t){e.logError(t),e.statusMessage("getRobotList(): error: "+t)})},t.prototype.createCertificate=function(){var e=this,t="https://"+this._robotInfo.endpoint+"/rom/v1/certificates",n={friendlyId:this._robotInfo.serialName};r.default({method:"post",headers:{"User-Agent":"Mozilla/5.0",Accept:"application/json","Content-Type":"application/json",Authorization:this._tokenType+" "+this._accessToken},url:t,data:JSON.stringify(n)}).then(function(t){e.statusMessage("createCertificate(): success"),e._robotInfo.ip="",e._numTries=0,e._gotCertificate=!1,e._p12Certificate="",e._certificateFingerprint="",e._interval=setInterval(e.retrieveCertificate.bind(e),5e3)}).catch(function(t){e.logError(t),e.statusMessage("createCertificate(): error: "+t)})},t.prototype.retrieveCertificate=function(){var e=this;if(!this._gotCertificate&&this._numTries++<t.MAX_TRIES){this.statusMessage("retrieveCertificate(): attempt #: "+this._numTries);var n="https://"+this._robotInfo.endpoint+"/rom/v1/certificates/client?friendlyId="+this._robotInfo.serialName;this.logDebug("certificateRetrievalUri: "+n);var o=r.default.CancelToken.source();r.default({method:"get",headers:{"User-Agent":"Mozilla/5.0",Accept:"application/json","Content-Type":"application/json",Authorization:this._tokenType+" "+this._accessToken},url:n,cancelToken:o.token}).then(function(t){if(200==t.status){clearInterval(e._interval),e._gotCertificate=!0;var n=t.data.data;e.logDebug("Recieved a certificate! Robot ip address: "+n.payload.ipAddress);var r=n.payload.ipAddress;e._robotInfo.ip=r;var s=n.private;e._p12Certificate=n.cert,e._certificateFingerprint=n.fingerprint,e.logDebug("retrieveCertificate: connecting to robot..."),e.statusMessage("retrieveCertificate(): success: connecting to robot..."),e.connectToRobot(r,s,e._p12Certificate,e._certificateFingerprint,function(t){e.logDebug("retrieveCertificate: connected: ",t)})}else e.logError("retrieveCertificate(): response: code: "+t.status,t),e.statusMessage("retrieveCertificate(): response: 404"),o.cancel("retrieveCertificate(): too many tries.")}).catch(function(t){e.logError(t),e.statusMessage("retrieveCertificate(): error: "+t)})}else clearInterval(this._interval),this.logDebug("Tried "+this._numTries+" times. Aborting."),this.statusMessage("retrieveCertificate(): attempted "+this._numTries+" times. Aborting."),this._gotCertificate||(this.logError("Unable to retrieve a certificate. Aborting."),this.statusMessage("Unable to retrieve a certificate. Aborting."),this._connected=!1,this.emit("disconnected"),this._robotInfo.onDisconnected&&this._robotInfo.onDisconnected())},t.prototype.connectToRobot=function(e,n,o,r,s){var a=this,c={port:this._connectionInfo.port||t.DEFAULT_PORT,key:n,cert:o,rejectUnauthorized:!1,perMessageDeflate:!1,fingerprint:r};this._requester=new i.Requester,this._requester.disconnected.on(function(e){a.logError("JiboConnection: connectToRobot: Connection closed because",e),a.statusMessage("connectToRobot(): error: Connection closed because: "+JSON.stringify(e,null,2)),a._connected=!1,a._requester=void 0,a.emit("disconnected"),a._robotInfo.onDisconnected&&a._robotInfo.onDisconnected()}),this._requester.connect(e,c).then(function(){a._requester?(a._connected=!0,a._robotInfo.onConnected&&a._robotInfo.onConnected(a._requester),s&&s(a._requester),a.emit("connected",a._requester),a.logDebug("JiboConnection: connectToRobot: OK"),a.statusMessage("connectToRobot(): Connection: OK:")):(a.logDebug("JiboConnection: connectToRobot: requester is undefined"),a.statusMessage("connectToRobot(): Connection: requester is undefined"))}).catch(function(e){a.logError("JiboConnection: connectToRobot: error",e),a.statusMessage("connectToRobot(): error: "+e)})},t.prototype.disconnect=function(){this._requester&&this._connected&&(this._requester.disconnect(),this._requester=void 0,this._connected=!1,this.emit("disconnected"),this._robotInfo.onDisconnected&&this._robotInfo.onDisconnected(),this.statusMessage("disconnect()"))},Object.defineProperty(t.prototype,"connected",{get:function(){return this._connected},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"requester",{get:function(){return this._connected?this._requester:void 0},enumerable:!0,configurable:!0}),t.prototype.statusMessage=function(e,t){void 0===t&&(t=!1),this.emit("statusMessage",{message:e,subsystem:"JiboConnection <"+this._robotInfo.name+">",clearMessages:t})},t.prototype.logDebug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._debugLogging&&console.log.apply(this,e)},t.prototype.logError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(this,e)},t.MAX_TRIES=40,t.DEFAULT_PORT=7160,t.DEV_ENDPOINT="dev-customer-portal.jibo.com",t.STG_ENDPOINT="stg-customer-portal.jibo.com",t.PREPROD_ENDPOINT="preprod-customer-portal.jibo.com",t.PROD_ENDPOINT="portal.jibo.com",t.ENVIRONMENT_OPTIONS={DEV_ENDPOINT:t.DEV_ENDPOINT,STG_ENDPOINT:t.STG_ENDPOINT,PREPROD_ENDPOINT:t.PREPROD_ENDPOINT,PROD_ENDPOINT:t.PROD_ENDPOINT},t}(s.EventEmitter);t.JiboConnection=a},function(e,t,n){e.exports=n(36)},function(e,t,n){"use strict";var o=n(3),r=n(16),s=n(38),i=n(10);function a(e){var t=new s(e),n=r(s.prototype.request,t);return o.extend(n,s.prototype,t),o.extend(n,t),n}var c=a(i);c.Axios=s,c.create=function(e){return a(o.merge(i,e))},c.Cancel=n(25),c.CancelToken=n(62),c.isCancel=n(24),c.all=function(e){return Promise.all(e)},c.spread=n(63),e.exports=c,e.exports.default=c},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";var o=n(10),r=n(3),s=n(57),i=n(58);function a(e){this.defaults=e,this.interceptors={request:new s,response:new s}}a.prototype.request=function(e){"string"==typeof e&&(e=r.merge({url:arguments[0]},arguments[1])),(e=r.merge(o,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[i,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},r.forEach(["delete","get","head","options"],function(e){a.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}}),r.forEach(["post","put","patch"],function(e){a.prototype[e]=function(t,n,o){return this.request(r.merge(o||{},{method:e,url:t,data:n}))}}),e.exports=a},function(e,t,n){"use strict";var o=n(3);e.exports=function(e,t){o.forEach(e,function(n,o){o!==t&&o.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[o])})}},function(e,t,n){"use strict";var o=n(3),r=n(17),s=n(19),i=n(41),a=n(42),c=n(11),u="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(43);e.exports=function(e){return new Promise(function(t,p){var l=e.data,f=e.headers;o.isFormData(l)&&delete f["Content-Type"];var h=new XMLHttpRequest,d="onreadystatechange",v=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in h||a(e.url)||(h=new window.XDomainRequest,d="onload",v=!0,h.onprogress=function(){},h.ontimeout=function(){}),e.auth){var _=e.auth.username||"",y=e.auth.password||"";f.Authorization="Basic "+u(_+":"+y)}if(h.open(e.method.toUpperCase(),s(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h[d]=function(){if(h&&(4===h.readyState||v)&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in h?i(h.getAllResponseHeaders()):null,o={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:1223===h.status?204:h.status,statusText:1223===h.status?"No Content":h.statusText,headers:n,config:e,request:h};r(t,p,o),h=null}},h.onerror=function(){p(c("Network Error",e,null,h)),h=null},h.ontimeout=function(){p(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",h)),h=null},o.isStandardBrowserEnv()){var m=n(44),g=(e.withCredentials||a(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;g&&(f[e.xsrfHeaderName]=g)}if("setRequestHeader"in h&&o.forEach(f,function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete f[t]:h.setRequestHeader(t,e)}),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){h&&(h.abort(),p(e),h=null)}),void 0===l&&(l=null),h.send(l)})}},function(e,t,n){"use strict";var o=n(3),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,i={};return e?(o.forEach(e.split("\n"),function(e){if(s=e.indexOf(":"),t=o.trim(e.substr(0,s)).toLowerCase(),n=o.trim(e.substr(s+1)),t){if(i[t]&&r.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([n]):i[t]?i[t]+", "+n:n}}),i):i}},function(e,t,n){"use strict";var o=n(3);e.exports=o.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var o=e;return t&&(n.setAttribute("href",o),o=n.href),n.setAttribute("href",o),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=o.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function r(){this.message="String contains an invalid character"}r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,n,s=String(e),i="",a=0,c=o;s.charAt(0|a)||(c="=",a%1);i+=c.charAt(63&t>>8-a%1*8)){if((n=s.charCodeAt(a+=.75))>255)throw new r;t=t<<8|n}return i}},function(e,t,n){"use strict";var o=n(3);e.exports=o.isStandardBrowserEnv()?{write:function(e,t,n,r,s,i){var a=[];a.push(e+"="+encodeURIComponent(t)),o.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),o.isString(r)&&a.push("path="+r),o.isString(s)&&a.push("domain="+s),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var o=n(3),r=n(17),s=n(19),i=n(7),a=n(12),c=n(20).http,u=n(20).https,p=n(13),l=n(23),f=n(56),h=n(11),d=n(18);e.exports=function(e){return new Promise(function(t,n){var v,_=e.data,y=e.headers;if(y["User-Agent"]||y["user-agent"]||(y["User-Agent"]="axios/"+f.version),_&&!o.isStream(_)){if(Buffer.isBuffer(_));else if(o.isArrayBuffer(_))_=new Buffer(new Uint8Array(_));else{if(!o.isString(_))return n(h("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));_=new Buffer(_,"utf-8")}y["Content-Length"]=_.length}var m=void 0;e.auth&&(m=(e.auth.username||"")+":"+(e.auth.password||""));var g=p.parse(e.url),b=g.protocol||"http:";if(!m&&g.auth){var w=g.auth.split(":");m=(w[0]||"")+":"+(w[1]||"")}m&&delete y.Authorization;var C="https:"===b,T=C?e.httpsAgent:e.httpAgent,E={path:s(g.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method,headers:y,agent:T,auth:m};e.socketPath?E.socketPath=e.socketPath:(E.hostname=g.hostname,E.port=g.port);var k,S=e.proxy;if(!S&&!1!==S){var x=b.slice(0,-1)+"_proxy",O=process.env[x]||process.env[x.toUpperCase()];if(O){var P=p.parse(O);if(S={host:P.hostname,port:P.port},P.auth){var R=P.auth.split(":");S.auth={username:R[0],password:R[1]}}}}if(S&&(E.hostname=S.host,E.host=S.host,E.headers.host=g.hostname+(g.port?":"+g.port:""),E.port=S.port,E.path=b+"//"+g.hostname+(g.port?":"+g.port:"")+E.path,S.auth)){var A=new Buffer(S.auth.username+":"+S.auth.password,"utf8").toString("base64");E.headers["Proxy-Authorization"]="Basic "+A}e.transport?k=e.transport:0===e.maxRedirects?k=C?a:i:(e.maxRedirects&&(E.maxRedirects=e.maxRedirects),k=C?u:c),e.maxContentLength&&e.maxContentLength>-1&&(E.maxBodyLength=e.maxContentLength);var L=k.request(E,function(o){if(!L.aborted){clearTimeout(v),v=null;var s=o;switch(o.headers["content-encoding"]){case"gzip":case"compress":case"deflate":s=s.pipe(l.createUnzip()),delete o.headers["content-encoding"]}var i=o.req||L,a={status:o.statusCode,statusText:o.statusMessage,headers:o.headers,config:e,request:i};if("stream"===e.responseType)a.data=s,r(t,n,a);else{var c=[];s.on("data",function(t){c.push(t),e.maxContentLength>-1&&Buffer.concat(c).length>e.maxContentLength&&n(h("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,i))}),s.on("error",function(t){L.aborted||n(d(t,e,null,i))}),s.on("end",function(){var o=Buffer.concat(c);"arraybuffer"!==e.responseType&&(o=o.toString("utf8")),a.data=o,r(t,n,a)})}}});L.on("error",function(t){L.aborted||n(d(t,e,null,L))}),e.timeout&&!v&&(v=setTimeout(function(){L.abort(),n(h("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",L))},e.timeout)),e.cancelToken&&e.cancelToken.promise.then(function(e){L.aborted||(L.abort(),n(e))}),o.isStream(_)?_.pipe(L):L.end(_)})}},function(e,t){e.exports=require("assert")},function(e,t,n){"undefined"==typeof process||"renderer"===process.type?e.exports=n(48):e.exports=n(50)},function(e,t,n){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=n(22)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var o="color: "+this.color;e.splice(1,0,o,"color: inherit");var r=0,s=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(s=++r)}),e.splice(s,0,o)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())},function(e,t){var n=1e3,o=60*n,r=60*o,s=24*r,i=365.25*s;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*i;case"days":case"day":case"d":return a*s;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*o;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===c&&!1===isNaN(e))return t.long?function(e){return a(e,s,"day")||a(e,r,"hour")||a(e,o,"minute")||a(e,n,"second")||e+" ms"}(e):function(e){if(e>=s)return Math.round(e/s)+"d";if(e>=r)return Math.round(e/r)+"h";if(e>=o)return Math.round(e/o)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){var o=n(51),r=n(52);(t=e.exports=n(22)).init=function(e){e.inspectOpts={};for(var n=Object.keys(t.inspectOpts),o=0;o<n.length;o++)e.inspectOpts[n[o]]=t.inspectOpts[n[o]]},t.log=function(){return process.stderr.write(r.format.apply(r,arguments)+"\n")},t.formatArgs=function(e){var n=this.namespace;if(this.useColors){var o=this.color,r="[3"+(o<8?o:"8;5;"+o),s="  "+r+";1m"+n+" [0m";e[0]=s+e[0].split("\n").join("\n"+s),e.push(r+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=(t.inspectOpts.hideDate?"":(new Date).toISOString()+" ")+n+" "+e[0]},t.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=i,t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):o.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{var s=n(53);s&&s.level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}function i(){return process.env.DEBUG}t.inspectOpts=Object.keys(process.env).filter(function(e){return/^debug_/i.test(e)}).reduce(function(e,t){var n=t.substring(6).toLowerCase().replace(/_([a-z])/g,function(e,t){return t.toUpperCase()}),o=process.env[t];return o=!!/^(yes|on|true|enabled)$/i.test(o)||!/^(no|off|false|disabled)$/i.test(o)&&("null"===o?null:Number(o)),e[n]=o,e},{}),t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts).split("\n").map(function(e){return e.trim()}).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,r.inspect(e,this.inspectOpts)},t.enable(i())},function(e,t){e.exports=require("tty")},function(e,t){e.exports=require("util")},function(e,t,n){"use strict";const o=n(54),r=n(55),s=process.env;let i;function a(e){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(function(e){if(!1===i)return 0;if(r("color=16m")||r("color=full")||r("color=truecolor"))return 3;if(r("color=256"))return 2;if(e&&!e.isTTY&&!0!==i)return 0;const t=i?1:0;if("win32"===process.platform){const e=o.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in s)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(e=>e in s)||"codeship"===s.CI_NAME?1:t;if("TEAMCITY_VERSION"in s)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION)?1:0;if("truecolor"===s.COLORTERM)return 3;if("TERM_PROGRAM"in s){const e=parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(s.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)?1:"COLORTERM"in s?1:(s.TERM,t)}(e))}r("no-color")||r("no-colors")||r("color=false")?i=!1:(r("color")||r("colors")||r("color=true")||r("color=always"))&&(i=!0),"FORCE_COLOR"in s&&(i=0===s.FORCE_COLOR.length||0!==parseInt(s.FORCE_COLOR,10)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},function(e,t){e.exports=require("os")},function(e,t,n){"use strict";e.exports=((e,t)=>{t=t||process.argv;const n=e.startsWith("-")?"":1===e.length?"-":"--",o=t.indexOf(n+e),r=t.indexOf("--");return-1!==o&&(-1===r||o<r)})},function(e){e.exports={name:"axios",version:"0.18.0",description:"Promise based HTTP client for the browser and node.js",main:"index.js",scripts:{test:"grunt test && bundlesize",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js"},repository:{type:"git",url:"https://github.com/axios/axios.git"},keywords:["xhr","http","ajax","promise","node"],author:"Matt Zabriskie",license:"MIT",bugs:{url:"https://github.com/axios/axios/issues"},homepage:"https://github.com/axios/axios",devDependencies:{bundlesize:"^0.5.7",coveralls:"^2.11.9","es6-promise":"^4.0.5",grunt:"^1.0.1","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.0.0","grunt-contrib-nodeunit":"^1.0.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^19.0.0","grunt-karma":"^2.0.0","grunt-ts":"^6.0.0-beta.3","grunt-webpack":"^1.0.18","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^1.3.0","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.0.0","karma-firefox-launcher":"^1.0.0","karma-jasmine":"^1.0.2","karma-jasmine-ajax":"^0.1.13","karma-opera-launcher":"^1.0.0","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^1.1.0","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^1.7.0","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",sinon:"^1.17.4",webpack:"^1.13.1","webpack-dev-server":"^1.14.1","url-search-params":"^0.6.1",typescript:"^2.0.3"},browser:{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},typings:"./index.d.ts",dependencies:{"follow-redirects":"^1.3.0","is-buffer":"^1.1.5"},bundlesize:[{path:"./dist/axios.min.js",threshold:"5kB"}]}},function(e,t,n){"use strict";var o=n(3);function r(){this.handlers=[]}r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=r},function(e,t,n){"use strict";var o=n(3),r=n(59),s=n(24),i=n(10),a=n(60),c=n(61);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!a(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=r(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||i.adapter)(e).then(function(t){return u(e),t.data=r(t.data,t.headers,e.transformResponse),t},function(t){return s(t)||(u(e),t&&t.response&&(t.response.data=r(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var o=n(3);e.exports=function(e,t,n){return o.forEach(n,function(n){e=n(e,t)}),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var o=n(25);function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r(function(t){e=t}),cancel:e}},e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(26);t.Requester=o.default,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(32));var r=n(0);t.enums=r;var s=n(4);t.Event=s.Event},function(e,t,n){"use strict";var o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e};Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),s=n(66),i=function(){function e(){this.onConnection=this.onConnection.bind(this),this.onClose=this.onClose.bind(this),this.namedConnections={},this.connected=new r.Event("Connected"),this.disconnected=new r.Event("Disconnected"),this.message=new r.Event("Message Received")}return e.prototype.connect=function(e,t){var n=this;return this.isConnected(e)?Promise.resolve({robot:e}):new Promise(function(r,s){n.connected.on(r),n.startWebSocket(o({hostname:e},t),function(e){n.connected.off(r),s(e)})})},e.prototype.close=function(){for(var e in this.namedConnections)this.namedConnections[e].close();this.namedConnections={}},e.prototype.isConnected=function(e){return e in this.namedConnections},e.prototype.sendTo=function(e,t){this.isConnected(e)&&this.namedConnections[e].send(JSON.stringify(t))},e.prototype.startWebSocket=function(e,t){var n=this,o=e.hostname,r=e.port||8160,i=(e.cert?"wss":"ws")+"://"+o+":"+r,a={};if(e.cert&&(a.key=e.key,a.cert=e.cert,a.rejectUnauthorized=!1),this.namedConnections[o]){try{this.namedConnections[o].close()}catch(e){}this.namedConnections[o]=null}try{var c;c="object"==typeof process?this.namedConnections[o]=new s(i,a):this.namedConnections[o]=new WebSocket(i,a);var u=function(e){t&&t(e),c.onerror=function(){},n.onClose(o,0,"Error in websocket"),c.removeEventListener("error",u)};c.addEventListener("error",u),c.addEventListener("open",function(){n.onConnection(o,c)}),c.addEventListener("close",function(e){return n.onClose(o,e.code,e.reason)})}catch(e){console.log("ConnectionManager: startWebSocket: err:",e),this.namedConnections[o]=null}},e.prototype.onConnection=function(e,t){var n=this;this.connected.emit({robot:e}),this.namedConnections[e]=t,t.addEventListener("message",function(t){t.data&&(t=t.data);var o=JSON.parse(t.toString());n.message.emit({robot:e,data:o})})},e.prototype.onClose=function(e,t,n){this.namedConnections[e]&&(this.disconnected.emit({robot:e,code:t,reason:n}),this.namedConnections[e].close(),this.namedConnections[e]=null)},e}();t.default=i},function(e,t,n){"use strict";const o=n(27);o.Server=n(71),o.Receiver=n(29),o.Sender=n(31),e.exports=o},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("tls")},function(e,t,n){"use strict";function o(e){if(!(this instanceof o))return new o(e);e=e||{},this.concurrency=e.concurrency||1/0,this.pending=0,this.jobs=[],this.cbs=[],this._done=function(){this.pending--,this._run()}.bind(this)}["push","unshift","splice"].forEach(function(e){o.prototype[e]=function(){var t=Array.prototype[e].apply(this.jobs,arguments);return this._run(),t}}),Object.defineProperty(o.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),o.prototype._run=function(){if(this.pending!==this.concurrency){if(this.jobs.length){var e=this.jobs.shift();this.pending++,e(this._done),this._run()}if(0===this.pending)for(;0!==this.cbs.length;){var t=this.cbs.pop();process.nextTick(t)}}},o.prototype.onDone=function(e){"function"==typeof e&&(this.cbs.push(e),this._run())},e.exports=o},function(e,t,n){"use strict";class o{constructor(e,t){this.target=t,this.type=e}}class r extends o{constructor(e,t){super("message",t),this.data=e}}class s extends o{constructor(e,t,n){super("close",n),this.wasClean=n._closeFrameReceived&&n._closeFrameSent,this.reason=t,this.code=e}}class i extends o{constructor(e){super("open",e)}}class a extends o{constructor(e,t){super("error",t),this.message=e.message,this.error=e}}const c={addEventListener(e,t){function n(e){t.call(this,new r(e,this))}function o(e,n){t.call(this,new s(e,n,this))}function c(e){t.call(this,new a(e,this))}function u(){t.call(this,new i(this))}"function"==typeof t&&("message"===e?(n._listener=t,this.on(e,n)):"close"===e?(o._listener=t,this.on(e,o)):"error"===e?(c._listener=t,this.on(e,c)):"open"===e?(u._listener=t,this.on(e,u)):this.on(e,t))},removeEventListener(e,t){const n=this.listeners(e);for(var o=0;o<n.length;o++)n[o]!==t&&n[o]._listener!==t||this.removeListener(e,n[o])}};e.exports=c},function(e,t,n){"use strict";const o=n(14),r=n(8),s=n(7),i=n(9),a=n(28),c=n(6),u=n(27);function p(e){e.emit("close")}function l(){this.destroy()}function f(e,t,n,o){e.writable&&(n=n||s.STATUS_CODES[t],o=Object.assign({Connection:"close","Content-type":"text/html","Content-Length":Buffer.byteLength(n)},o),e.write(`HTTP/1.1 ${t} ${s.STATUS_CODES[t]}\r\n`+Object.keys(o).map(e=>`${e}: ${o[e]}`).join("\r\n")+"\r\n\r\n"+n)),e.removeListener("error",l),e.destroy()}e.exports=class extends o{constructor(e,t){if(super(),null==(e=Object.assign({maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null},e)).port&&!e.server&&!e.noServer)throw new TypeError('One of the "port", "server", or "noServer" options must be specified');null!=e.port?(this._server=s.createServer((e,t)=>{const n=s.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server&&(this._removeListeners=function(e,t){for(const n of Object.keys(t))e.on(n,t[n]);return function(){for(const n of Object.keys(t))e.removeListener(n,t[n])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(e,t,n)=>{this.handleUpgrade(e,t,n,t=>{this.emit("connection",t,e)})}})),!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(e&&this.once("close",e),this.clients)for(const e of this.clients)e.terminate();const t=this._server;t&&(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port)?t.close(()=>this.emit("close")):process.nextTick(p,this)}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,o){t.on("error",l);const r=+e.headers["sec-websocket-version"],s={};if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!e.headers["sec-websocket-key"]||8!==r&&13!==r||!this.shouldHandle(e))return f(t,400);if(this.options.perMessageDeflate){const n=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const o=a.parse(e.headers["sec-websocket-extensions"]);o[i.extensionName]&&(n.accept(o[i.extensionName]),s[i.extensionName]=n)}catch(e){return f(t,400)}}if(this.options.verifyClient){const i={origin:e.headers[`${8===r?"sec-websocket-origin":"origin"}`],secure:!(!e.connection.authorized&&!e.connection.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(i,(r,i,a,c)=>{if(!r)return f(t,i||401,a,c);this.completeUpgrade(s,e,t,n,o)});if(!this.options.verifyClient(i))return f(t,401)}this.completeUpgrade(s,e,t,n,o)}completeUpgrade(e,t,n,o,s){if(!n.readable||!n.writable)return n.destroy();const p=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${r.createHash("sha1").update(t.headers["sec-websocket-key"]+c.GUID,"binary").digest("base64")}`],f=new u(null);var h=t.headers["sec-websocket-protocol"];if(h&&(h=h.trim().split(/ *, */),(h=this.options.handleProtocols?this.options.handleProtocols(h,t):h[0])&&(p.push(`Sec-WebSocket-Protocol: ${h}`),f.protocol=h)),e[i.extensionName]){const t=e[i.extensionName].params,n=a.format({[i.extensionName]:[t]});p.push(`Sec-WebSocket-Extensions: ${n}`),f._extensions=e}this.emit("headers",p,t),n.write(p.concat("\r\n").join("\r\n")),n.removeListener("error",l),f.setSocket(n,o,this.options.maxPayload),this.clients&&(this.clients.add(f),f.on("close",()=>this.clients.delete(f))),s(f)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(73);t.loadAssets=o;var r=n(77);t.unloadAssets=r;var s=n(78);t.session=s;var i=n(79);t.camera=i;var a=n(82);t.expression=a;var c=n(88);t.listen=c;var u=n(91);t.lps=u;var p=n(94);t.sensory=p;var l=n(97);t.settings=l},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case i.FetchAssetEvents.AssetReady:this.isComplete=!0,this._complete.resolve(t);break;case i.FetchAssetEvents.AssetFailed:this.isComplete=!0,this._complete.reject(t)}},t}(r.default);t.FetchAssetToken=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e,t){return{Type:i.CommandTypes.FetchAsset,URI:e,Name:t}},t.prototype.fetchAsset=function(e,n){var o=t.generateProtocol(e,n);return this.generateToken(o,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new a(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.LoadAssets=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})}}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PhotoEvents={TakePhoto:"onTakePhoto"},t.VideoEvents={VideoReady:"onVideoReady"},t.DisconnectReason={4000:"Skill closed by user",4001:"Skill closed due to robot error",4002:"Incoming connection is replacing previous connection",4003:"Connection closed due to inactivity",4004:"Session closed due to reconnection time out",4005:"Session closed due to failed reconnection"},t.DisconnectCode={HeadTouchExit:4e3,RobotError:4001,NewConnection:4002,InactivityTimeout:4003,ReconnectTimeout:4004,ReconnectError:4005},t.ResponseStrings={200:"OK",201:"Created",202:"Accepted",400:"Bad Request",403:"Forbidden",404:"Not Found",406:"Not Acceptable",407:"Request Timeout",409:"Conflict",412:"Precondition Failed",500:"Internal Error",503:"Service Unavailable",505:"Version Not Supported",506:"Version Conflict"},t.AttentionMode={Off:"OFF",Idle:"IDLE",Disengage:"DISENGAGE",Engaged:"ENGAGED",Speaking:"SPEAKING",Fixated:"FIXATED",Attractable:"ATTRACTABLE",Menu:"MENU",Command:"COMMAND"},t.CommandTypes={StartSession:"StartSession",GetConfig:"GetConfig",SetConfig:"SetConfig",Cancel:"Cancel",Display:"Display",SetAttention:"SetAttention",Say:"Say",Listen:"Listen",LookAt:"LookAt",TakePhoto:"TakePhoto",Video:"Video",Subscribe:"Subscribe",FetchAsset:"FetchAsset",VideoPlayback:"VideoPlayback",UnloadAsset:"UnloadAsset"},t.AsyncCommandEvent={Start:"onStart",Stop:"onStop",Error:"onError"},t.DisplayEvents={ViewStateChange:"onViewStateChange"},t.ViewStates={Opened:"Opened",Closed:"Closed"},t.DisplayViewType={Eye:"Eye",Text:"Text",Image:"Image"},t.LookAtEvents={LookAtAchieved:"onLookAtAchieved",TrackEntityLost:"onTrackEntityLost"},t.HotWordEvents={HotWordHeard:"onHotWordHeard",ListenResult:"onListenResult"},t.StreamTypes={Entity:"Entity",HotWord:"HotWord",HeadTouch:"HeadTouch",Motion:"Motion",ScreenGesture:"ScreenGesture"},t.ListenEvents={ListenResult:"onListenResult"},t.ListenStopReasons={NoInput:"NoInput",NoMatch:"NoMatch",Interrupted:"Interrupted"},t.EntityTrackEvents={TrackUpdate:"onEntityUpdate",TrackLost:"onEntityLost",TrackGained:"onEntityGained"},t.MotionEvents={MotionDetected:"onMotionDetected"},t.HeadTouchEvents={HeadTouched:"onHeadTouch"},t.ScreenGestureEvents={Tap:"onTap",Swipe:"onSwipe"},t.ConfigEvents={onConfig:"onConfig"},t.FetchAssetEvents={AssetReady:"onAssetReady",AssetFailed:"onAssetFailed"},t.UnloadAssetEvents={UnloadAssetDone:"onUnloadAssetDone",UnloadAssetFailed:"onUnloadAssetFailed"},t.CameraResolution={HighRes:"highRes",MedRes:"medRes",LowRes:"lowRes",MicroRes:"microRes"},t.SwipeDirection={Up:"Up",Down:"Down",Right:"Right",Left:"Left"},t.Camera={Left:"left",Right:"right"},t.EntityType={Person:"person",Unknown:"unknown"},t.DisplayErrorDetails={IdNotUnique:"View id is not unique",MissingValues:"View was not given required values",InvalidViewType:"View type is not valid",AssetError:"Unable to access assets for display"},t.DisplayChangeType={Swap:"Swap"},t.FetchAssetErrorDetails={OutOfMemory:"Out of memory",InvalidURI:"Invalid or Inaccessible URI"},t.UnloadAssetErrorDetails={InvalidName:"Invalid or Inaccessible Name"},t.ResponseCode={OK:200,Created:201,Accepted:202,BadRequest:400,Forbidden:403,NotFound:404,NotAcceptable:406,RequestTimeout:407,Conflict:409,PreconditionFailed:412,InternalError:500,ServiceUnavailable:503,VersionNotSupported:505,VersionConflict:506},t.VideoType={Normal:"NORMAL",Debug:"DEBUG"},t.ProtocolVersions={v1:"1.0",v2:"2.0"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEvent=function(e){return e.hasOwnProperty("EventBody")},t.isAcknowledgement=function(e){return e.hasOwnProperty("Response")},t.isAngleTarget=function(e){return e.hasOwnProperty("Angle")},t.isEntityTarget=function(e){return e.hasOwnProperty("Entity")},t.isPositionTarget=function(e){return e.hasOwnProperty("Position")},t.isCameraTarget=function(e){return e.hasOwnProperty("ScreenCoords")}},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case i.UnloadAssetEvents.UnloadAssetDone:this.isComplete=!0,this._complete.resolve(t);break;case i.UnloadAssetEvents.UnloadAssetFailed:this.isComplete=!0,this._complete.reject(t)}},t}(r.default);t.UnloadAssetToken=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e){return{Type:i.CommandTypes.UnloadAsset,Name:e}},t.prototype.unloadAsset=function(e){var n=t.generateProtocol(e);return this.generateToken(n,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new a(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.UnloadAssets=c},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){return e.Response.ResponseCode>=400?(this.isComplete=!0,void this._complete.reject(e.Response)):e.Response.ResponseCode===i.ResponseCode.OK?(this.isComplete=!0,void this._complete.resolve(e.Response)):void 0},t.prototype.handleEvent=function(e){},t}(r.default);t.SessionToken=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(){return{Type:i.CommandTypes.StartSession}},t.prototype.startSession=function(){var e=t.generateProtocol();return this.generateToken(e,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new a(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t}(s.default);t.Session=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(80);t.photo=o;var r=n(81);t.video=r},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=i.ResponseCode.BadRequest)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;t.Event===i.PhotoEvents.TakePhoto&&(this.isComplete=!0,this._complete.resolve(t))},t}(r.default);t.PhotoToken=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e,t,n){return void 0===e&&(e="left"),void 0===t&&(t="lowRes"),void 0===n&&(n=!0),{Type:i.CommandTypes.TakePhoto,Resolution:t,Camera:e,Distortion:n}},t.prototype.takePhoto=function(e,n,o){void 0===e&&(e="lowRes"),void 0===n&&(n="left"),void 0===o&&(o=!0);var r=t.generateProtocol(n,e,o);return this.generateToken(r,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new a(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t}(s.default);t.Photo=c},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(4),a=n(0),c=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.streamReady=new i.Event("Video ready for streaming"),o}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=a.ResponseCode.BadRequest)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;t.Event===a.VideoEvents.VideoReady&&this.streamReady.emit(t.URI)},t}(r.default);t.VideoToken=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e,t){return void 0===e&&(e="NORMAL"),void 0===t&&(t=0),{Type:a.CommandTypes.Video,Duration:t,VideoType:e}},t.prototype.getVideo=function(e,n){void 0===e&&(e="NORMAL"),void 0===n&&(n=0);var o=t.generateProtocol(e,n);return this.generateToken(o,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new c(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t}(s.default);t.Video=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(83);t.attention=o;var r=n(84);t.lookAt=r;var s=n(85);t.display=s;var i=n(86);t.play=i;var a=n(87);t.video=a},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response);200===e.Response.ResponseCode&&(this.isComplete=!0,this._complete.resolve())},t.prototype.handleEvent=function(e){},t}(r.default);t.AttentionToken=i;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e){return{Type:"SetAttention",Mode:e}},t.prototype.setMode=function(e){var n=t.generateProtocol(e);return this.generateToken(n,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new i(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t}(s.default);t.Attention=a},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(1),i=n(2),a=n(0);!function(e){e[e.Position=0]="Position",e[e.Angle=1]="Angle",e[e.Entity=2]="Entity",e[e.Screen=3]="Screen"}(r=t.TargetMode||(t.TargetMode={}));var c=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case a.AsyncCommandEvent.Stop:this.isComplete=!0,this._complete.resolve();break;case a.AsyncCommandEvent.Error:this.isComplete=!0,this._complete.reject(t);break;case a.LookAtEvents.LookAtAchieved:case a.LookAtEvents.TrackEntityLost:this.isComplete=!0,this._complete.resolve(t)}},t}(s.default);t.LookAtToken=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e,t,n,o){var s;switch(void 0===o&&(o=!1),e){case r.Position:s={Position:t};break;case r.Angle:s={Angle:t};break;case r.Entity:s={Entity:t};break;case r.Screen:s={ScreenCoords:t}}return{Type:a.CommandTypes.LookAt,LookAtTarget:s,TrackFlag:o,LevelHeadFlag:n}},t.prototype.position=function(e,n){void 0===n&&(n=!0);var o=t.generateProtocol(r.Position,e,n,!1);return this.generateToken(o,!0)},t.prototype.angle=function(e,n){void 0===n&&(n=!0);var o=t.generateProtocol(r.Angle,e,n,!1);return this.generateToken(o,!0)},t.prototype.screenPosition=function(e,n){void 0===n&&(n=!0);var o=t.generateProtocol(r.Screen,e,n,!1);return this.generateToken(o,!0)},t.prototype.entity=function(e,n,o){void 0===o&&(o=!0);var s=t.generateProtocol(r.Entity,e,o,n);return this.generateToken(s,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new c(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t}(i.default);t.LookAt=u},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(4),a=n(0),c=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.opened=new i.Event("Opened"),o}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case a.AsyncCommandEvent.Stop:this.isComplete=!0,this._complete.resolve();break;case a.AsyncCommandEvent.Error:this.isComplete=!0,this._complete.reject(t);break;case a.DisplayEvents.ViewStateChange:switch(t.State){case a.ViewStates.Opened:this.opened.emit()}}},t}(r.default);t.DisplayToken=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e){return{Type:a.CommandTypes.Display,View:e}},t.prototype.swap=function(e){return this.swapView(e)},t.prototype.swapView=function(e){var n=t.generateProtocol(e);return this.generateToken(n,!0)},t.prototype.createEyeView=function(e){return{Type:a.DisplayViewType.Eye,Name:e}},t.prototype.createTextView=function(e,t){return{Type:a.DisplayViewType.Text,Name:e,Text:t}},t.prototype.createImageView=function(e,t){return{Type:a.DisplayViewType.Image,Name:e,Image:t}},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new c(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t}(s.default);t.Display=u},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){switch(e.EventBody.Event){case i.AsyncCommandEvent.Stop:this.isComplete=!0,this._complete.resolve();break;case i.AsyncCommandEvent.Error:this.isComplete=!0,this._complete.reject(e.EventBody)}},t}(r.default);t.SayToken=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e,t,n){return{Type:i.CommandTypes.Say,ESML:e,SpeakOptions:t,AutoRuleConfig:n}},t.prototype.say=function(e,n,o){var r=t.generateProtocol(e,n,o);return this.generateToken(r,!0)},t.prototype.sound=function(e){var n=t.generateProtocol(e);return this.generateToken(n,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new a(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.Play=c},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response);200===e.Response.ResponseCode&&(this.isComplete=!0,this._complete.resolve())},t.prototype.handleEvent=function(e){},t}(r.default);t.VideoPlaybackToken=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e){return{Type:i.CommandTypes.VideoPlayback,URI:e,Name:"somename"}},t.prototype.play=function(e){var n=t.generateProtocol(e);return this.generateToken(n,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new a(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t}(s.default);t.VideoPlayback=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(89);t.hotWord=o;var r=n(90);t.listen=r},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(4),a=n(0),c=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.hotWordHeard=new i.Event("Heard hot word"),o.listenResult=new i.Event("Listen complete"),o}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case a.HotWordEvents.HotWordHeard:this.hotWordHeard.emit(t)}},t}(r.default);t.HotWordToken=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e){return void 0===e&&(e=!1),{Type:a.CommandTypes.Subscribe,StreamType:a.StreamTypes.HotWord,StreamFilter:{},Listen:e}},t.prototype.listen=function(e){void 0===e&&(e=!1);var n=t.generateProtocol(e);return this.generateToken(n,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new c(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.HotWord=u},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(4),i=n(2),a=n(0),c=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.update=new s.Event("Update of listen status"),o}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case a.AsyncCommandEvent.Stop:this.isComplete=!0,this._complete.reject(t);break;case a.ListenEvents.ListenResult:this.isComplete=!0,this._complete.resolve(t),this.update.emit(t);break;case a.AsyncCommandEvent.Error:this.isComplete=!0,this._complete.reject(t)}},t}(r.default);t.ListenToken=c;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.subscribe={hotword:void 0},t}return o(t,e),t.generateProtocol=function(e,t,n){return void 0===e&&(e=15),void 0===t&&(t=15),void 0===n&&(n="en-US"),{Type:a.CommandTypes.Listen,MaxSpeechTimeout:e,MaxNoSpeechTimeout:t,LanguageCode:n}},t.prototype.start=function(e,t,n){return void 0===e&&(e=15),void 0===t&&(t=15),void 0===n&&(n="en-US"),this.listen(e,t,n)},t.prototype.listen=function(e,n,o){void 0===e&&(e=15),void 0===n&&(n=15),void 0===o&&(o="en-US");var r=t.generateProtocol(e,n,o);return this.generateToken(r,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new c(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(i.default);t.Listen=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(92);t.face=o;var r=n(93);t.motion=r},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(4),a=n(0),c=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.update=new i.Event("Update of tracked entities"),o.gained=new i.Event("Entity found"),o.lost=new i.Event("Entity lost"),o}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case a.EntityTrackEvents.TrackGained:this.gained.emit(t.Tracks);break;case a.EntityTrackEvents.TrackUpdate:this.update.emit(t.Tracks);break;case a.EntityTrackEvents.TrackLost:this.lost.emit(t.Tracks)}},t}(r.default);t.FaceTrackToken=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(){return{Type:a.CommandTypes.Subscribe,StreamType:a.StreamTypes.Entity,StreamFilter:{}}},t.prototype.trackFaces=function(){var e=t.generateProtocol();return this.generateToken(e,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new c(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.FaceTrack=u},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(4),a=n(0),c=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.update=new i.Event("Update of motion entities"),o}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case a.MotionEvents.MotionDetected:this.update.emit(t.Motions)}},t}(r.default);t.MotionToken=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(){return{Type:a.CommandTypes.Subscribe,StreamType:a.StreamTypes.Motion,StreamFilter:{}}},t.prototype.trackMotions=function(){var e=t.generateProtocol();return this.generateToken(e,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new c(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.MotionTrack=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(95);t.headTouch=o;var r=n(96);t.screenGesture=r},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(4),a=n(0),c=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.update=new i.Event("Update of head touch status"),o}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case a.AsyncCommandEvent.Stop:this.isComplete=!0,this._complete.resolve();break;case a.AsyncCommandEvent.Error:this.isComplete=!0,this._complete.reject();break;case a.HeadTouchEvents.HeadTouched:this.update.emit(t.Pads)}},t}(r.default);t.HeadTouchToken=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(){return{Type:a.CommandTypes.Subscribe,StreamType:a.StreamTypes.HeadTouch,StreamFilter:{}}},t.prototype.listen=function(){var e=t.generateProtocol();return this.generateToken(e,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new c(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.HeadTouch=u},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(4),a=n(0),c=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.tap=new i.Event(a.ScreenGestureEvents.Tap),o.swipe=new i.Event(a.ScreenGestureEvents.Swipe),o}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case a.AsyncCommandEvent.Stop:this.isComplete=!0,this._complete.resolve();break;case a.AsyncCommandEvent.Error:this.isComplete=!0,this._complete.reject(t);break;case a.ScreenGestureEvents.Tap:this.tap.emit(t.Coordinate);break;case a.ScreenGestureEvents.Swipe:this.swipe.emit(t.Direction)}},t}(r.default);t.ScreenGestureToken=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e){return void 0===e&&(e={}),{Type:a.CommandTypes.Subscribe,StreamType:a.StreamTypes.ScreenGesture,StreamFilter:e}},t.prototype.subscribe=function(e){void 0===e&&(e={});var n=t.generateProtocol(e);return this.generateToken(n,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new c(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.ScreenGesture=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(98);t.getConfig=o;var r=n(99);t.setConfig=r},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){var t=e.EventBody;switch(t.Event){case i.ConfigEvents.onConfig:this.isComplete=!0,this._complete.resolve(t)}},t}(r.default);t.GetConfigToken=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(){return{Type:i.CommandTypes.GetConfig}},t.prototype.get=function(){var e=t.generateProtocol();return this.generateToken(e,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new a(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.GetConfig=c},function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),s=n(2),i=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.handleAck=function(e){if(e.Response.ResponseCode>=400)return this.isComplete=!0,void this._complete.reject(e.Response)},t.prototype.handleEvent=function(e){switch(e.EventBody.Event){case i.AsyncCommandEvent.Stop:this.isComplete=!0,this._complete.resolve();break;case i.AsyncCommandEvent.Error:this.isComplete=!0,this._complete.reject(e.EventBody)}},t}(r.default);t.SetConfigToken=a;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateProtocol=function(e){return{Type:i.CommandTypes.SetConfig,Options:e}},t.prototype.set=function(e){var n=t.generateProtocol(e);return this.generateToken(n,!0)},t.prototype.generateToken=function(t,n){void 0===n&&(n=!1);var o=new a(this.owner,t);return n&&e.prototype.sendToken.call(this,o),o},t.prototype.sendToken=function(e){this.owner.sendToken(e)},t}(s.default);t.SetConfig=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(101);t.structural=o;var r=n(104);t.emotion=r;var s=n(106);t.perception=s;var i=n(108);t.play=i;var a=n(109);t.listen=a;var c=n(110);t.display=c;var u=n(111);t.slim=u},function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(102)),o(n(103))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(){function e(){}return e.generateProtocol=function(e,t){return void 0===t&&(t=!1),{id:o.generateTransactionID(),type:"PARALLEL",children:e,succeedOnFirst:t}},e}();t.Parallel=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(){function e(){}return e.generateProtocol=function(e){return{id:o.generateTransactionID(),type:"SEQUENCE",children:e}},e}();t.Sequence=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(105))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(){function e(){}return e.generateProtocol=function(e,t){return{id:o.generateTransactionID(),type:"IMPACT_EMOTION",valence:e,confidence:t}},e}();t.ImpactEmotion=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(107))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(){function e(){}return e.generateProtocol=function(e,t,n){return{id:o.generateTransactionID(),type:"SET_PRESENT_PERSON",looperId:e,source:t,confidence:n}},e}();t.SetPresentPerson=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(){function e(){}return e.generateProtocol=function(e,t,n){return{id:o.generateTransactionID(),type:"PLAY",autoRuleConfig:t,speakOptions:n,esml:e}},e}();t.Play=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(){function e(){}return e.generateProtocol=function(e,t){var n=Array.isArray(e)?e:[e];return{id:o.generateTransactionID(),type:"LISTEN",contexts:n,intents:t}},e}();t.Listen=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(){function e(){}return e.generateProtocol=function(e,t,n,r,s,i,a){return{id:o.generateTransactionID(),type:"DISPLAY",name:e,view:t,layer:n,overlay:a,visible:r,keepDisplay:s,onCancel:i}},e}();t.Display=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r=function(){function e(){}return e.generateProtocol=function(e,t){return{id:o.generateTransactionID(),type:"SLIM",config:e,options:t}},e}();t.SLIM=r}])});
//# sourceMappingURL=index.js.map